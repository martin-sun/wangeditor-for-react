{"version":3,"file":"core.js","names":["React","_interopRequireWildcard","require","_wangeditor","_interopRequireDefault","_uniqueId","_helper","_type","_htmlRender","_imgFile","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","ReactWEditor","PureComponent","constructor","_args","_defineProperty2","createId","ImgFile","zIndex","hooks","args","target","forEach","hook","index","apply","test","path","split","cache","fn","d","push","length","placeholder","onChange","onFocus","onBlur","linkImgCallback","onlineVideoCallback","localBlobImg","props","defaultConfig","onchange","onfocus","onblur","customUploadImg","resultFiles","insertImgFn","file","url","URL","createObjectURL","imgFile","saveImgFiles","flag","hasCreated","changeCreatedFlag","UNSAFE_componentWillReceiveProps","nextProps","value","isEqualString","setContentByHTMLString","componentDidUpdate","prevProps","componentDidMount","_isMounted","init","create","console","error","componentWillUnmount","editor","destroy","resetImgFiles","imgFiles","getAllImgFiles","keys","startsWith","revokeObjectURL","__before__instanced","globalHook","values","__hook__run","WEditor","__after__instanced","check","instanceHook","elem","document","getElementById","id","setDefaultConfigByProps","setConfig","context","config","defaultValue","extend","created","customFilter","filter","concat","difference","key","isCreated","destroyed","assign","languages","isEmpty","html","txt","replaceHTMLImgBlobURL","callback","render","style","className","createElement","exports"],"sources":["../src/core.tsx"],"sourcesContent":["/*\n * @Author: donggg\n * @LastEditors: donggg\n * @Date: 2021-07-02 10:23:15\n * @LastEditTime: 2022-03-07 17:28:40\n */\nimport * as React from 'react';\nimport WEditor from 'wangeditor';\nimport createId from './utils/unique-id';\nimport { isEmpty, difference, isEqualString } from './utils/helper';\nimport { ReactWEProps } from './type';\nimport { replaceHTMLImgBlobURL } from './utils/htmlRender';\nimport ImgFile from './imgFile';\n\ninterface IWEditor extends WEditor {\n\t[key: string]: unknown;\n}\n\ninterface ReactWEditorState {\n\t[key: string]: unknown;\n}\n\nexport default class ReactWEditor extends React.PureComponent<ReactWEProps, ReactWEditorState> {\n\t// Explicitly define props and state types\n\tpublic declare readonly props: ReactWEProps;\n\tpublic state: ReactWEditorState = {};\n\tprivate readonly id = createId(8);\n\tprivate hasCreated = false; // 是否执行 create 创建函数\n\n\tprotected imgFile = new ImgFile();\n\tprotected defaultConfig: Record<string, unknown> = {\n\t\tzIndex: 1,\n\t};\n\n\tpublic editor: WEditor | null = null;\n\tprivate _isMounted = false;\n\n\t// This method is considered legacy and should be avoided in new code\n\t// We'll keep it for backward compatibility but use componentDidUpdate for React 18\n\tUNSAFE_componentWillReceiveProps(nextProps: ReactWEProps) {\n\t\tconst { value } = nextProps;\n\n\t\tif (!isEqualString(value as string, this.props.value as string)) {\n\t\t\tthis.setContentByHTMLString(this.props.value);\n\t\t}\n\t}\n\n\tcomponentDidUpdate(prevProps: ReactWEProps) {\n\t\tconst { value } = this.props;\n\n\t\tif (!isEqualString(value as string, prevProps.value as string)) {\n\t\t\tthis.setContentByHTMLString(value);\n\t\t}\n\t}\n\tcomponentDidMount(): void {\n\t\tthis._isMounted = true;\n\t\ttry {\n\t\t\tthis.init();\n\t\t\tthis.create();\n\t\t} catch (e) {\n\t\t\tconsole.error(`[ReactWEditor Error]: ${e}`);\n\t\t}\n\t}\n\n\tcomponentWillUnmount(): void {\n\t\t// Mark component as unmounted\n\t\tthis._isMounted = false;\n\t\t\n\t\t// Clean up the editor\n\t\tif (this.editor) {\n\t\t\tthis.editor.destroy();\n\t\t\tthis.editor = null;\n\t\t}\n\n\t\t// Clean up any Blob URLs\n\t\tif (this.imgFile) {\n\t\t\tthis.imgFile.resetImgFiles();\n\t\t}\n\n\t\t// Revoke any object URLs that might have been created\n\t\tif (this.imgFile) {\n\t\t\tconst imgFiles = this.imgFile.getAllImgFiles();\n\t\t\tObject.keys(imgFiles).forEach(url => {\n\t\t\t\tif (url.startsWith('blob:')) {\n\t\t\t\t\tURL.revokeObjectURL(url);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate __hook__run = (\n\t\thooks: string[] = [],\n\t\targs: Array<unknown> = [],\n\t\ttarget: WEditor | typeof WEditor,\n\t) => {\n\t\thooks.forEach((hook, index) => {\n\t\t\tif (\n\t\t\t\thook in target &&\n\t\t\t\ttypeof (target as IWEditor)[hook] === 'function' &&\n\t\t\t\targs[index]\n\t\t\t) {\n\t\t\t\t(target as any)[hook].apply((target as any)[hook], args[index]);\n\t\t\t} else if (/^(\\w+\\.\\w+)+$/.test(hook) && args[index]) {\n\t\t\t\tconst path = hook.split('.');\n\t\t\t\tconst cache = [];\n\t\t\t\tlet fn: any = target;\n\t\t\t\tpath.forEach((d: string) => {\n\t\t\t\t\tcache.push(fn);\n\t\t\t\t\tfn = fn[d];\n\t\t\t\t});\n\t\t\t\tcache.push(fn);\n\t\t\t\tif (typeof fn === 'function') {\n\t\t\t\t\tfn.apply(cache[cache.length - 2], args[index]);\n\t\t\t\t} else if (typeof args[index] === 'function') {\n\t\t\t\t\t(args[index] as (...args: unknown[]) => void).apply(\n\t\t\t\t\t\targs[index],\n\t\t\t\t\t\tcache,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\tprivate __before__instanced() {\n\t\tconst { globalHook = {} } = this.props;\n\t\tconst hooks = Object.keys(globalHook);\n\t\tconst args: unknown[] = Object.values(globalHook);\n\n\t\tthis.__hook__run(hooks, args, WEditor);\n\t}\n\n\tprivate __after__instanced() {\n\t\tif (!this.check()) {\n\t\t\treturn;\n\t\t}\n\t\tconst { instanceHook = {} } = this.props;\n\t\tconst hooks = Object.keys(instanceHook);\n\t\tconst args = Object.values(instanceHook);\n\n\t\tthis.__hook__run(hooks, args, this.editor as WEditor);\n\t}\n\n\tprotected init(): void {\n\t\tconst elem = document.getElementById(`editor-${this.id}`);\n\t\tif (elem) {\n\t\t\t// 0. 初始化前，调用全局的 hook\n\t\t\tthis.__before__instanced();\n\n\t\t\t// 1. 初始化\n\t\t\tthis.editor = new WEditor(`#editor-${this.id}`);\n\n\t\t\t// 2. 初始化后，调用实例的 hook，支持相对路径，例如键值是 'menus.extend'\n\t\t\tthis.__after__instanced();\n\n\t\t\t// 3. 根据属性配置默认设置\n\t\t\tthis.setDefaultConfigByProps();\n\n\t\t\t// 4. 根据默认设置更新设置\n\t\t\tthis.setConfig(this.defaultConfig);\n\t\t} else {\n\t\t\tconsole.error('[ReactWEditor Error]: dom is not found');\n\t\t}\n\t}\n\n\tprotected check(): boolean {\n\t\tif (this.editor) {\n\t\t\treturn true;\n\t\t}\n\t\tconsole.error('[ReactWEditor Error]: editor not found');\n\t\treturn false;\n\t}\n\n\tprotected create(context = {}): void {\n\t\tconst { config, defaultValue } = this.props;\n\t\tif (this.check()) {\n\t\t\t// 1. 根据 config 属性配置设置\n\t\t\tthis.setConfig(config);\n\n\t\t\t// 2. 扩展 edtior\n\t\t\tthis.extend(context);\n\n\t\t\t// 3. 生成 editor\n\t\t\t(this.editor as WEditor).create();\n\n\t\t\t// 4. 修改标识\n\t\t\tthis.created();\n\n\t\t\t// 5. 根据 defaultValue 设置内容\n\t\t\tthis.setContentByHTMLString(defaultValue);\n\t\t}\n\t}\n\n\t/**\n\t * 通过 context 扩展 edtior\n\t * @param {object} context 待扩展的内容\n\t * @param {array} customFilter 需要过滤的扩展字段\n\t */\n\textend(\n\t\tcontext: Record<string, unknown> = {},\n\t\tcustomFilter: string[] = [],\n\t): void {\n\t\tif (this.check()) {\n\t\t\t// 1. 过滤数组\n\t\t\tconst filter = Object.keys(this.editor as WEditor).concat(\n\t\t\t\tcustomFilter || [],\n\t\t\t);\n\n\t\t\t// 2. 向 editor 上扩展\n\t\t\tdifference(Object.keys(context), filter).forEach(\n\t\t\t\t(key) => ((this.editor as IWEditor)[key] = context[key]),\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * 销毁编辑器\n\t */\n\tdestroy(): void {\n\t\tif (!this.isCreated()) {\n\t\t\tconsole.error(\n\t\t\t\t\"[ReactWEditor Error]: editor has not created, don't destroy.\",\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\t\t// 1. 销毁\n\t\t(this.editor as WEditor).destroy();\n\t\tthis.editor = null;\n\n\t\t// 2. 修改标识\n\t\tthis.destroyed();\n\t}\n\n\t/**\n\t * 配置 editor\n\t * @param {*} config 配置\n\t * @doc https://www.wangeditor.com/doc/\n\t */\n\tsetConfig(config: Record<string, unknown> | undefined): void {\n\t\tif (config) {\n\t\t\t(this.editor as WEditor).config = Object.assign(\n\t\t\t\t(this.editor as WEditor).config,\n\t\t\t\tconfig,\n\t\t\t);\n\t\t}\n\n\t\t// 多语言处理\n\t\tconst { languages } = this.props;\n\t\tif (languages && !isEmpty(languages)) {\n\t\t\t(this.editor as WEditor).config.languages = Object.assign(\n\t\t\t\t(this.editor as WEditor).config.languages,\n\t\t\t\tlanguages,\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * 根据属性，配置默认设置\n\t */\n\tsetDefaultConfigByProps = (): void => {\n\t\tconst {\n\t\t\tplaceholder,\n\t\t\tonChange,\n\t\t\tonFocus,\n\t\t\tonBlur,\n\t\t\tlinkImgCallback,\n\t\t\tonlineVideoCallback,\n\t\t\tlocalBlobImg,\n\t\t} = this.props;\n\n\t\tif (placeholder) this.defaultConfig.placeholder = placeholder;\n\t\tif (onChange) this.defaultConfig.onchange = onChange;\n\t\tif (onFocus) this.defaultConfig.onfocus = onFocus;\n\t\tif (onBlur) this.defaultConfig.onblur = onBlur;\n\t\tif (linkImgCallback) this.defaultConfig.linkImgCallback = linkImgCallback;\n\t\tif (onlineVideoCallback)\n\t\t\tthis.defaultConfig.onlineVideoCallback = onlineVideoCallback;\n\n\t\t// 图片替换为本地Blob伪URL\n\t\tif (localBlobImg) {\n\t\t\tthis.defaultConfig.customUploadImg = (\n\t\t\t\tresultFiles: File[],\n\t\t\t\tinsertImgFn: (...arg: unknown[]) => void,\n\t\t\t): void => {\n\t\t\t\tresultFiles.forEach((file: File) => {\n\t\t\t\t\tconst url = URL.createObjectURL(file);\n\t\t\t\t\tthis.imgFile.saveImgFiles(url, file);\n\t\t\t\t\tinsertImgFn(url);\n\t\t\t\t});\n\t\t\t};\n\t\t}\n\t};\n\n\t/**\n\t * 设置 editor 内容。注意！必须在创建完 editor 后才可以设置内容\n\t * @param {string} html 回填的 html 字符串\n\t */\n\tsetContentByHTMLString(html: string | undefined): void {\n\t\tif (!this.isCreated()) {\n\t\t\tconsole.error('[ReactWEditor Error]: editor has not created');\n\t\t}\n\n\t\tif (this.check()) {\n\t\t\ttry {\n\t\t\t\t(this.editor as WEditor).txt.html(html);\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(`[ReactWEditor Error]: ${e}`);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * 替换 html 中的 img 标签的 src 引用地址\n\t * @param {string} html html 文本\n\t * @param {function} callback 替换过程中的回调函数\n\t * @returns 替换后的 html 文本\n\t */\n\treplaceHTMLImgBlobURL(\n\t\thtml: string,\n\t\tcallback: (v: File | { toString: () => string }) => string,\n\t): string {\n\t\treturn replaceHTMLImgBlobURL(html, this.imgFile.getAllImgFiles(), callback);\n\t}\n\trender() {\n\t\tconst { style, className } = this.props;\n\t\treturn React.createElement('div', {\n\t\t\tstyle: style as React.CSSProperties,\n\t\t\tclassName,\n\t\t\tid: `editor-${this.id}`\n\t\t});\n\t}\n\n\tchangeCreatedFlag = (flag: boolean): boolean => (this.hasCreated = flag);\n\tcreated = (): boolean => this.changeCreatedFlag(true);\n\tdestroyed = (): boolean => this.changeCreatedFlag(false);\n\tisCreated = (): boolean => this.hasCreated === true;\n}\n"],"mappings":"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","ignoreList":[]}